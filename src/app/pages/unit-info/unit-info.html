<div class="min-h-screen w-full bg-gray-800 p-8 text-white">

  @if (isLoading) {
     <div class="flex flex-col items-center justify-center mt-20 animate-pulse space-y-4">
      <div class="h-32 w-full max-w-4xl bg-gray-800 rounded-2xl"></div>
      <div class="h-20 w-full max-w-4xl bg-gray-800 rounded-xl"></div>
    </div>
  }

  @else if (unitData) {
    <div class="max-w-[95%] mx-auto space-y-10">
      
      <div class="bg-gray-900 rounded-2xl border border-gray-300 shadow-xl overflow-hidden flex flex-col">
        
        <div class="px-8 py-4 border-b border-gray-300 flex flex-wrap items-center justify-between gap-4">
          
          <h1 class="text-2xl font-bold text-white tracking-wide">
            {{ unitData.name }}
          </h1>

          

          <div class="flex items-center gap-6">
            <div class="h-4 w-px bg-gray-300"></div>
            
            <span class="text-gray-300 font-medium  flex items-center gap-2">
              {{ unitData.courses.length }} Cours
            </span>

            <div class="h-4 w-px bg-gray-300"></div>

            <div class="flex items-center gap-6">
               <span class="text-gray-300 font-medium  flex items-center gap-2">Niveau {{ unitData.difficulty }}</span>
            </div>
          </div>

        </div>

        <div class="px-5 py-3 text-gray-300 leading-relaxed text-lg italic">
          {{ unitData.description || 'Aucune description disponible pour ce module.' }}
        </div>

      </div>

      <app-course-display 
        [courses]="unitData.courses"
        [unitId]="unitData.id"
        (deleteCourseRequest)="handleDeleteCourse($event)"
        (deleteExerciseRequest)="handleDeleteExercise($event)">
      </app-course-display>

      @if (!isAddingCourse) {
        <button (click)="startAddingCourse()" 
                class="w-full py-4 mt-6 rounded-xl border-2 border-dashed border-gray-300 text-gray-300 hover:bg-gray-700/50 flex items-center justify-center gap-2 font-bold group cursor-pointer">
            
            <span class="text-xl ">+</span> 
            <span>Ajouter un cours</span>
        
        </button>
      }

      @else {
        
        <div class="bg-gray-900 rounded-xl border border-gray-300 overflow-hidden shadow-2xl  mt-6">
            
            <div class="flex flex-col md:flex-row md:items-start gap-4 p-5 border-b border-gray-300">
                
                <input type="text" [(ngModel)]="newCourse.name" 
                       placeholder="Nom du cours..." 
                       class="bg-transparent text-lg font-bold text-white placeholder-gray-300 focus:outline-none border-b border-transparent focus:border-white w-full md:w-1/4"
                       autoFocus>

                <div class="hidden md:block h-8 w-px bg-gray-300 mt-1"></div>

                <textarea [(ngModel)]="newCourse.description" 
                          placeholder="Description du cours..." 
                          rows="2"
                          class="flex-1 bg-transparent text-sm text-gray-300 focus:outline-none border border-transparent focus:border-gray-300 rounded p-1 resize-none"></textarea>

            </div>

            @if (errorMessage) {
              <div class="px-5 py-2 text-red-400 text-sm font-bold bg-red-900/20 border-t border-red-900/50 flex items-center gap-2">
                   {{ errorMessage }}
              </div>
    }

            <div class="p-3 bg-gray-800 flex  items-center justify-between gap-3">

                <div class="flex items-center gap-2">
                    
                    <div class="flex items-center gap-2 bg-gray-900 border border-gray-300 rounded px-2 py-1">
                        <span class="text-xs font-medium text-gray-300 whitespace-nowrap">Niv</span>
                        <input type="number" min="1" max="5" [(ngModel)]="newCourse.difficulty"
                               class="bg-transparent text-white w-8 text-center focus:outline-none font-bold text-xs">
                    </div>

                    <select [(ngModel)]="newCourse.visibility" 
                            class="bg-gray-900 border border-gray-300 text-gray-300 text-xs rounded px-2 py-1 focus:outline-none cursor-pointer">
                        <option value="public">Public</option>
                        <option value="private">Privé</option>
                    </select>
                </div>

                <div class="flex items-center gap-2">
                  <button (click)="cancelAdding()" 
                          class="px-4 py-1.5 rounded text-gray-300  text-sm font-medium cursor-pointer">
                      Annuler
                  </button>

                  <button (click)="submitCourse()" 
                          [disabled]="isCreating"
                          class="px-4 py-1.5 bg-white text-gray-900 rounded font-bold text-sm disabled:opacity-50 cursor-pointer">
                      {{ isCreating ? 'Création...' : 'Valider' }}
                  </button>
                </div>
            </div>

        </div>
      }

    </div>
  }

  @else {
    <div class="text-center mt-20 text-red-500">Module introuvable :(</div>
  }
</div>